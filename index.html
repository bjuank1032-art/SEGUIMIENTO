<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Sistema 3 de Junio - Admin & Testing</title>
    
    <!-- Scripts de Dependencias -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        
        body {
            background-color: black;
            color: #e5e5e5;
            font-family: 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent;
            padding-bottom: 120px;
        }

        .admin-panel {
            background: #1c1c1e;
            border-bottom: 1px solid #333;
            position: sticky;
            top: 0;
            z-index: 9999;
            box-shadow: 0 4px 20px rgba(0,0,0,0.8);
        }

        .glass-modal {
            background: rgba(15, 15, 15, 0.98) !important;
            backdrop-filter: blur(40px) !important;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .input-dark {
            background: #0a0a0a;
            border: 1px solid #1a1a1a;
            color: white;
            border-radius: 1rem;
            padding: 1rem;
        }

        .roadmap-line-gradient { 
            background: linear-gradient(to bottom, #ef4444, #3b82f6, #10b981, #f59e0b, #a855f7); 
        }

        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
        .failure-alert { animation: shake 0.2s ease-in-out infinite; }

        .btn-sync {
            background: white;
            color: black;
            font-weight: 900;
            letter-spacing: 0.1em;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .btn-sync:active { transform: scale(0.95); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        // --- CONSTANTES ---
        const KEY_H = 'res_v13_habits';
        const KEY_W = 'last_win_date';
        const KEY_API = 'gemini_stored_key';
        const KEY_R = 'res_v13_roadmap';
        const COLORS = ['#007aff', '#34c759', '#ff3b30', '#ff9500', '#af52de', '#ff2d55', '#00c7be'];
        const DAYS_WEEK = ["Lunes", "Martes", "Mi茅rcoles", "Jueves", "Viernes", "S谩bado", "Domingo"];

        // --- COMPONENTE ICONO ---
        const Icon = ({ name, className = "w-5 h-5", color = "currentColor" }) => {
            const iconRef = useRef(null);
            useEffect(() => {
                if (iconRef.current && window.lucide) {
                    iconRef.current.innerHTML = '';
                    const i = document.createElement('i');
                    const lucideName = name.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();
                    i.setAttribute('data-lucide', lucideName);
                    i.className = className;
                    i.style.stroke = color;
                    i.style.strokeWidth = "2.5";
                    iconRef.current.appendChild(i);
                    window.lucide.createIcons();
                }
            }, [name, className, color]);
            return <span ref={iconRef} className="inline-flex items-center justify-center"></span>;
        };

        const App = () => {
            // --- ESTADO ADMIN: SIMULADOR DE TIEMPO ---
            const [timeOffset, setTimeOffset] = useState(0); 
            const simulatedNow = useMemo(() => new Date(Date.now() + timeOffset * 86400000), [timeOffset]);
            const simulatedHoyStr = simulatedNow.toISOString().split('T')[0];

            // --- ESTADOS DE LA APP ---
            const [activeTab, setActiveTab] = useState('seguimiento');
            const [habits, setHabits] = useState(() => JSON.parse(localStorage.getItem(KEY_H)) || []);
            const [lastWinDate, setLastWinDate] = useState(() => localStorage.getItem(KEY_W) || null);
            const [roadmap, setRoadmap] = useState(() => JSON.parse(localStorage.getItem(KEY_R)) || [
                { id: 1, title: "NIVEL 1: EL RESET BIOQUMICO", tag: "FASE 1", tasks: ["Purga de parafernalia estricta", "Cero contacto con consumo", "Dormir 10:30 PM"], impact: "Recuperar la voluntad biol贸gica.", objectives: ["1", "6", "7"] },
                { id: 2, title: "NIVEL 2: MENTE Y ESTABILIDAD", tag: "FASE 2", tasks: ["Meditaci贸n diaria", "Ejercicio intenso"], impact: "Eliminar la incertidumbre.", objectives: ["2", "3", "4"] }
            ]);

            const [showAddModal, setShowAddModal] = useState(false);
            const [showSettings, setShowSettings] = useState(false);
            const [showJuez, setShowJuez] = useState(false);
            const [editingHabit, setEditingHabit] = useState(null);
            
            const [storedApiKey, setStoredApiKey] = useState(localStorage.getItem(KEY_API) || "");
            const [reflection, setReflection] = useState("");
            const [aiFeedback, setAiFeedback] = useState("");
            const [isAiLoading, setIsAiLoading] = useState(false);

            const [formData, setFormData] = useState({ 
                name: "", icon: "", color: COLORS[0], duration: 30, type: 'simple', 
                routine: DAYS_WEEK.reduce((acc, day) => ({...acc, [day]: ""}), {}) 
            });

            // Persistencia
            useEffect(() => {
                localStorage.setItem(KEY_H, JSON.stringify(habits));
                localStorage.setItem(KEY_R, JSON.stringify(roadmap));
                if (lastWinDate) localStorage.setItem(KEY_W, lastWinDate);
            }, [habits, roadmap, lastWinDate]);

            // --- LGICA DE IA Y FRACASO ---
            const failurePorc = useMemo(() => {
                if (!lastWinDate) return 0;
                const last = new Date(lastWinDate); last.setHours(0,0,0,0);
                const today = new Date(simulatedNow); today.setHours(0,0,0,0);
                const diffDays = Math.floor((today - last) / (1000 * 60 * 60 * 24));
                return Math.min(100, diffDays * 20); 
            }, [lastWinDate, simulatedNow]);

            useEffect(() => {
                if (failurePorc >= 100) setShowJuez(true);
            }, [failurePorc]);

            const handleMark = (id) => {
                setHabits(prev => prev.map(h => {
                    if (h.id === id && !h.history.includes(simulatedHoyStr)) {
                        setLastWinDate(simulatedNow.toISOString());
                        return { ...h, history: [...h.history, simulatedHoyStr] };
                    }
                    return h;
                }));
            };

            const handleUnmark = (id) => {
                setHabits(prev => prev.map(h => {
                    if (h.id === id) {
                        return { ...h, history: h.history.filter(d => d !== simulatedHoyStr) };
                    }
                    return h;
                }));
            };

            const calculateStats = (h) => {
                const start = new Date(h.startDate); start.setHours(0,0,0,0);
                const today = new Date(simulatedNow); today.setHours(0,0,0,0);
                const totalElapsed = Math.floor((today - start) / (1000 * 60 * 60 * 24)) + 1;
                
                let activeDays = 0;
                const daysMap = ["Domingo", "Lunes", "Martes", "Mi茅rcoles", "Jueves", "Viernes", "S谩bado"];
                
                for(let i=0; i<totalElapsed; i++) {
                    const check = new Date(start); check.setDate(start.getDate() + i);
                    const dayName = daysMap[check.getDay()];
                    const task = h.type === 'routine' ? h.routine[dayName] : "Activo";
                    if (task && task.trim() !== "" && !task.toLowerCase().includes("descanso")) {
                        activeDays++;
                    }
                }
                const completed = h.history.length;
                const failed = Math.max(0, activeDays - completed);
                const progress = activeDays > 0 ? Math.min(100, Math.round((completed / activeDays) * 100)) : 100;
                return { completed, failed, progress };
            };

            const consultarAlJuez = async () => {
                if (!storedApiKey) return;
                setIsAiLoading(true);
                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${storedApiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: `He fallado el sistema por ${failurePorc/20} d铆as. Defensa: "${reflection}". Responde como un juez estricto.` }] }],
                            generationConfig: { responseMimeType: "application/json", responseSchema: { type: "OBJECT", properties: { valid: { type: "boolean" }, verdict: { type: "string" } } } }
                        })
                    });
                    const data = await response.json();
                    const res = JSON.parse(data.candidates[0].content.parts[0].text);
                    setAiFeedback(res.verdict);
                    if (res.valid) {
                        setTimeout(() => { setShowJuez(false); setLastWinDate(simulatedNow.toISOString()); setAiFeedback(""); }, 3000);
                    }
                } catch (e) { setAiFeedback("Error de conexi贸n IA."); } finally { setIsAiLoading(false); }
            };

            const handleSave = () => {
                if (!formData.name) return;
                if (editingHabit) {
                    setHabits(prev => prev.map(h => h.id === editingHabit.id ? {...h, ...formData} : h));
                } else {
                    setHabits(prev => [...prev, { ...formData, id: Date.now(), startDate: simulatedNow.toISOString(), history: [] }]);
                }
                setShowAddModal(false);
                setEditingHabit(null);
            };

            return (
                <div className="min-h-screen">
                    {/* --- ADMIN BAR --- */}
                    <div className="admin-panel p-3 px-6 flex items-center justify-between text-white">
                        <div className="flex flex-col">
                            <span className="text-[9px] font-black text-orange-500 uppercase tracking-widest">Panel de Control Admin</span>
                            <span className="text-[11px] font-mono text-neutral-400">Fecha Simulada: {simulatedHoyStr}</span>
                        </div>
                        <div className="flex gap-3">
                            <button onClick={() => setTimeOffset(prev => prev + 1)} className="bg-neutral-800 px-4 py-1.5 rounded-lg text-[10px] font-black uppercase">+1 D铆a</button>
                            <button onClick={() => setTimeOffset(0)} className="bg-neutral-800 px-4 py-1.5 rounded-lg text-[10px] font-black uppercase">Real</button>
                            <button onClick={() => setShowJuez(true)} className="bg-red-900/40 text-red-400 px-4 py-1.5 rounded-lg text-[10px] font-black uppercase">Juez</button>
                        </div>
                    </div>

                    <div className="max-w-2xl mx-auto px-6 pt-10 pb-40">
                        {activeTab === 'seguimiento' ? (
                            <div className="animate-in">
                                <header className="flex justify-between items-center mb-12">
                                    <h1 className="text-5xl font-black italic text-white uppercase tracking-tighter">Metas</h1>
                                    <button onClick={() => setShowSettings(true)} className="w-12 h-12 bg-neutral-900 border border-neutral-800 rounded-full flex items-center justify-center">
                                        <Icon name="Settings" color="#555" />
                                    </button>
                                </header>

                                {/* BARRA FRACASO */}
                                <div className={`p-10 rounded-[3rem] border-2 mb-10 transition-all ${failurePorc > 70 ? 'failure-alert border-red-600 bg-red-950/20' : 'bg-neutral-900/50 border-neutral-800'}`}>
                                    <div className="flex justify-between items-baseline mb-4">
                                        <span className="text-[10px] font-black text-neutral-500 uppercase tracking-widest">Estatus: Fracasado</span>
                                        <span className={`text-6xl font-black italic ${failurePorc > 70 ? 'text-red-500' : 'text-neutral-800'}`}>{failurePorc}%</span>
                                    </div>
                                    <div className="h-4 bg-black rounded-full overflow-hidden border border-neutral-800 p-1">
                                        <div className={`h-full rounded-full transition-all duration-500 ${failurePorc > 70 ? 'bg-red-600' : 'bg-neutral-800'}`} style={{ width: `${failurePorc}%` }} />
                                    </div>
                                </div>

                                {/* LISTA HABITOS */}
                                <div className="grid gap-6">
                                    {habits.map(h => {
                                        const stats = calculateStats(h);
                                        const isDone = h.history.includes(simulatedHoyStr);
                                        const todayName = ["Domingo", "Lunes", "Martes", "Mi茅rcoles", "Jueves", "Viernes", "S谩bado"][simulatedNow.getDay()];
                                        const isRest = h.type === 'routine' && h.routine[todayName]?.toLowerCase().includes("descanso");

                                        return (
                                            <div key={h.id} className={`p-8 rounded-[2.5rem] bg-neutral-900/40 border-2 transition-all ${isDone || isRest ? 'opacity-40 border-transparent' : 'border-neutral-800'}`} style={{ borderLeft: isRest ? '' : `14px solid ${h.color}` }}>
                                                <div className="flex justify-between items-center mb-6">
                                                    <div className="flex items-center gap-5">
                                                        <span className="text-4xl">{h.icon}</span>
                                                        <div>
                                                            <h3 className="text-2xl font-black italic text-white uppercase tracking-tighter leading-none mb-1">{h.name}</h3>
                                                            <p className="text-[10px] font-bold text-neutral-600 uppercase tracking-widest">
                                                                {h.type === 'routine' ? (isRest ? "Recuperaci贸n" : h.routine[todayName]) : "Plazo Activo"}
                                                            </p>
                                                        </div>
                                                    </div>
                                                    <div className="flex items-center gap-3">
                                                        {isDone ? (
                                                            <button onClick={() => handleUnmark(h.id)}><Icon name="CheckCircle2" color="#34c759" className="w-10 h-10" /></button>
                                                        ) : (
                                                            !isRest && <button onClick={() => handleMark(h.id)}><Icon name="Circle" color="#222" className="w-10 h-10" /></button>
                                                        )}
                                                    </div>
                                                </div>
                                                <div className="h-2 bg-black/50 rounded-full overflow-hidden mb-4"><div className="h-full transition-all duration-1000" style={{ width: `${stats.progress}%`, backgroundColor: h.color }} /></div>
                                                <div className="flex justify-between text-[10px] font-black uppercase italic text-neutral-500">
                                                    <span>Victorias: {stats.completed}</span>
                                                    <span>Fallos: {stats.failed}</span>
                                                </div>
                                            </div>
                                        );
                                    })}
                                    <button onClick={() => { setEditingHabit(null); setFormData({name: "", icon: "", color: COLORS[0], duration: 30, type: 'simple', routine: DAYS_WEEK.reduce((acc, day) => ({...acc, [day]: ""}), {}) }); setShowAddModal(true); }} className="py-14 border-2 border-dashed border-neutral-900 rounded-[3rem] text-neutral-800 font-black uppercase tracking-[0.4em]">+ Nueva Misi贸n</button>
                                </div>
                            </div>
                        ) : (
                            <div className="animate-in">
                                <header className="mb-14 pb-8 border-b border-neutral-900 flex items-center gap-6">
                                    <Icon name="Zap" className="w-10 h-10" />
                                    <h1 className="text-5xl font-black italic text-white uppercase tracking-tighter">Plan Maestro</h1>
                                </header>
                                <div className="flex flex-col lg:flex-row gap-12">
                                    <div className="lg:w-[320px] shrink-0">
                                        <div className="bg-neutral-950 p-10 rounded-[3rem] border border-white/5 sticky top-32">
                                            <h2 className="text-[10px] font-black uppercase tracking-[0.5em] text-neutral-700 mb-8 uppercase">Objetivos Base</h2>
                                            {["Sobriedad Total", "Aclara Futuro", "Cuerpo Atl茅tico", "Paz Mental"].map((obj, i) => (
                                                <div key={i} className="flex items-center gap-4 mb-4 text-[11px] font-bold text-neutral-500 italic uppercase">
                                                    <span className="w-6 h-6 rounded bg-neutral-900 flex items-center justify-center border border-neutral-800 text-[9px]">{i+1}</span>
                                                    {obj}
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                    <div className="flex-1 relative pl-20">
                                        <div className="absolute left-[24px] top-0 bottom-0 w-[2.5px] roadmap-line-gradient opacity-20 rounded-full" />
                                        {roadmap.map(step => (
                                            <div key={step.id} className="relative mb-12">
                                                <div className={`absolute -left-[76px] top-0 w-12 h-12 rounded-xl flex items-center justify-center z-10 border-2 transition-all ${expandedStep === step.id ? 'bg-white text-black border-white' : 'bg-black text-neutral-800 border-neutral-900'}`} onClick={() => setExpandedStep(step.id)}>
                                                    <span className="text-xl font-black italic">{step.id}</span>
                                                </div>
                                                <h3 className={`text-4xl font-black italic uppercase tracking-tighter transition-all mb-4 ${expandedStep === step.id ? 'text-white' : 'text-neutral-900'}`} onClick={() => setExpandedStep(step.id)}>{step.title}</h3>
                                                {expandedStep === step.id && (
                                                    <div className="p-10 rounded-[3.5rem] bg-neutral-900/40 border border-white/5 animate-in">
                                                        <ul className="space-y-4 mb-8">
                                                            {step.tasks.map((t, i) => <li key={i} className="text-sm font-bold text-neutral-300 flex items-center gap-3"><span className="w-2 h-2 rounded-full bg-neutral-700" />{t}</li>)}
                                                        </ul>
                                                        <div className="meta-final-box p-6"><h5 className="text-[9px] font-black text-neutral-700 uppercase mb-4 text-center">Meta Final</h5><p className="text-xs text-center font-black italic text-white uppercase">{step.impact}</p></div>
                                                    </div>
                                                )}
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>

                    {/* NAV */}
                    <nav className="fixed bottom-12 left-1/2 -translate-x-1/2 bg-neutral-900/95 border border-neutral-800 rounded-full p-2.5 flex gap-4 shadow-2xl z-[100] w-[340px]">
                        <button onClick={() => setActiveTab('seguimiento')} className={`flex-1 py-5 rounded-full font-black uppercase text-[11px] tracking-[0.3em] ${activeTab === 'seguimiento' ? 'bg-white text-black' : 'text-neutral-600'}`}>Metas</button>
                        <button onClick={() => setActiveTab('roadmap')} className={`flex-1 py-5 rounded-full font-black uppercase text-[11px] tracking-[0.3em] ${activeTab === 'roadmap' ? 'bg-white text-black' : 'text-neutral-600'}`}>Ruta</button>
                    </nav>

                    {/* MODAL CREAR/EDITAR META */}
                    {showAddModal && (
                        <div className="fixed inset-0 bg-black/95 z-[9000] flex items-center justify-center p-6 animate-in">
                            <div className="bg-neutral-950 w-full max-w-lg rounded-[4rem] p-12 border border-white/5 relative shadow-2xl">
                                <div className="flex justify-between items-center mb-10"><h2 className="text-3xl font-black italic text-white uppercase tracking-tighter">{editingHabit ? 'Editar Meta' : 'Crear Meta'}</h2><button onClick={() => setShowAddModal(false)} className="px-5 py-2 bg-neutral-900 rounded-xl text-[10px] font-black text-white">CERRAR</button></div>
                                <div className="space-y-8 max-h-[60vh] overflow-y-auto pr-2 custom-scrollbar">
                                    <div className="flex bg-black p-1.5 rounded-2xl border border-neutral-800">
                                        <button onClick={() => setFormData({...formData, type: 'simple'})} className={`flex-1 py-3 rounded-xl text-[10px] font-black uppercase ${formData.type === 'simple' ? 'bg-neutral-800 text-white' : 'text-neutral-600'}`}>Meta Simple</button>
                                        <button onClick={() => setFormData({...formData, type: 'routine'})} className={`flex-1 py-3 rounded-xl text-[10px] font-black uppercase ${formData.type === 'routine' ? 'bg-neutral-800 text-white' : 'text-neutral-600'}`}>Sistema Rutina</button>
                                    </div>
                                    <input type="text" value={formData.name} onChange={e => setFormData({...formData, name: e.target.value})} placeholder="Nombre de la misi贸n..." className="w-full input-dark text-lg font-black placeholder:text-neutral-800" />
                                    <div className="grid grid-cols-2 gap-4">
                                        <div className="space-y-2"><label className="text-[10px] font-black text-neutral-600 uppercase tracking-widest">Emoji</label><input type="text" value={formData.icon} onChange={e => setFormData({...formData, icon: e.target.value})} className="w-full input-dark text-center text-2xl" /></div>
                                        <div className="space-y-2"><label className="text-[10px] font-black text-neutral-600 uppercase tracking-widest">Plazo</label><input type="number" value={formData.duration} onChange={e => setFormData({...formData, duration: parseInt(e.target.value)})} className="w-full input-dark text-center font-black" /></div>
                                    </div>
                                    {formData.type === 'routine' && (
                                        <div className="space-y-4 pt-4 border-t border-white/5">
                                            {DAYS_WEEK.map(day => (
                                                <div key={day} className="flex items-center gap-4"><span className="w-20 text-[10px] font-black text-neutral-500 uppercase">{day}</span><input type="text" value={formData.routine[day]} onChange={e => setFormData({...formData, routine: {...formData.routine, [day]: e.target.value}})} placeholder="Descanso o Actividad" className="flex-1 input-dark p-2 text-xs" /></div>
                                            ))}
                                        </div>
                                    )}
                                </div>
                                <button onClick={handleSave} className="w-full btn-sync py-6 rounded-3xl mt-10 uppercase text-[12px]">Sincronizar Misi贸n</button>
                            </div>
                        </div>
                    )}

                    {/* MODAL AJUSTES */}
                    {showSettings && (
                        <div className="fixed inset-0 bg-black/90 z-[8000] flex items-center justify-center p-6 animate-in">
                            <div className="glass-modal w-full max-w-xl max-h-[85vh] overflow-y-auto rounded-[4rem] p-12 custom-scrollbar">
                                <div className="flex justify-between items-center mb-10 border-b border-neutral-900 pb-8"><h2 className="text-3xl font-black italic text-white uppercase tracking-tighter">Gesti贸n</h2><button onClick={() => setShowSettings(false)} className="w-10 h-10 bg-neutral-900 rounded-full flex items-center justify-center"><Icon name="X" /></button></div>
                                <div className="space-y-8">
                                    <div className="space-y-4"><label className="text-[11px] font-black text-neutral-700 uppercase tracking-widest block">LLAVE DE INTELIGENCIA (GEMINI)</label><input type="password" value={storedApiKey} onChange={e => {setStoredApiKey(e.target.value); localStorage.setItem(KEY_API, e.target.value);}} className="w-full bg-black border border-neutral-800 p-5 rounded-2xl text-white text-xs" /></div>
                                    <div className="pt-8 border-t border-neutral-900"><label className="text-[11px] font-black text-neutral-700 uppercase tracking-widest block mb-6">MISIONES ACTUALES</label>
                                        {habits.map(h => (
                                            <div key={h.id} className="flex justify-between items-center bg-neutral-900/50 p-6 rounded-[2.5rem] border border-neutral-800 mb-4">
                                                <div className="flex items-center gap-4"><span className="text-2xl">{h.icon}</span><span className="text-sm font-black italic text-neutral-300 uppercase">{h.name}</span></div>
                                                <div className="flex gap-2">
                                                    <button onClick={() => { setEditingHabit(h); setFormData({name:h.name, icon:h.icon, color:h.color, duration:h.duration, type:h.type, routine:h.routine}); setShowSettings(false); setShowAddModal(true); }} className="p-4 bg-neutral-800 rounded-2xl"><Icon name="Pencil" className="w-4 h-4 text-white" /></button>
                                                    <button onClick={() => setHabits(habits.filter(x => x.id !== h.id))} className="p-4 bg-red-950/20 rounded-2xl"><Icon name="Trash2" className="w-4 h-4 text-red-600" /></button>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* MODAL JUEZ (IA) */}
                    {showJuez && (
                        <div className="fixed inset-0 bg-black/98 z-[9999] flex items-center justify-center p-8 animate-in backdrop-blur-3xl">
                            <div className="glass-modal w-full max-w-2xl rounded-[5rem] p-16 text-center border-red-600/30">
                                <Icon name="ShieldAlert" className="w-24 h-24 mx-auto mb-10 text-red-600" />
                                <h1 className="text-5xl font-black italic text-white uppercase mb-6 tracking-tighter leading-none">Espejo de Realidad</h1>
                                <p className="text-[12px] font-black text-neutral-500 uppercase tracking-[0.5em] mb-12">DAS EN LA OSCURIDAD: {failurePorc/20}</p>
                                {aiFeedback ? (
                                    <div className="p-10 bg-red-950/20 border border-red-900/30 rounded-[3rem] text-lg italic text-red-100 uppercase tracking-tighter leading-snug">"{aiFeedback}"</div>
                                ) : (
                                    <div className="space-y-8 animate-in"><textarea value={reflection} onChange={e => setReflection(e.target.value)} placeholder="JUSTIFICA TU MEDIOCRIDAD..." className="w-full bg-black border border-neutral-800 p-8 rounded-[3rem] text-white text-xs uppercase tracking-widest min-h-[180px] outline-none" /><button onClick={consultarAlJuez} disabled={isAiLoading || !storedApiKey} className="w-full py-8 bg-white text-black font-black rounded-[3rem] uppercase text-[12px] tracking-[0.4em] active:scale-95 shadow-2xl transition-all">{isAiLoading ? 'PROCESANDO...' : 'ENVIAR DEFENSA'}</button></div>
                                )}
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
